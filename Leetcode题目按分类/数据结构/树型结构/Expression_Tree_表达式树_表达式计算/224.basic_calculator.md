

![20210805232738](https://i.loli.net/2021/08/06/ayP6Bv4hbIskY2e.png)

- 使用栈来解决

- 使用一个map来维护符号优先级

- 中缀转后缀

- 这个题目没有负数


- clarification: 1.表达式是否一定有效：怎么判断？  2.取值范围

invalid 表达式: 左右括号不匹配， 如果当前遍历到的「左括号」的数目严格小于「右括号」的数目则表达式无效
-



-- clarification: non-negative integer, assume expression is valid

```
Simple iterative solution by identifying characters one by one. One important thing is that the input is valid, which means the parentheses are always paired and in order.
Only 5 possible input we need to pay attention:

digit: it should be one digit from the current number
'+': number is over, we can add the previous number and start a new number
'-': same as above
'(': push the previous result and the sign into the stack, set result to 0, just calculate the new result within the parenthesis.
')': pop out the top two numbers from stack, first one is the sign before this pair of parenthesis, second is the temporary result before this pair of parenthesis. We add them together.
Finally if there is only one number, from the above solution, we haven't add the number to the result, so we do a check see if the number is zero.
``


```java
    public int calculate(String s) {
        // data range:integer
        // assume s is valid expression
        Deque<Integer> stack = new ArrayDeque<>();
        int len = s.length(), sign = 1, result = 0;
        
        // scan from left to right
        for (int i = 0; i < len; i++) {
            if (Character.isDigit(s.charAt(i))) {
                int sum = s.charAt(i) - '0';
                while (i + 1 < len && Character.isDigit(s.charAt(i + 1))) {
                    sum = sum * 10 + s.charAt(i +1) - '0';
                    i++;
                }
                result += sum * sign;
            } else if (s.charAt(i) == '+') {
                sign = 1;
            } else if (s.charAt(i) == '-') {
                sign = -1;
            } else if (s.charAt(i) == '(') {
                stack.push(result);
                stack.push(sign);
                result = 0;
                sign = 1;
            } else if (s.charAt(i) == ')') {
                result = result * stack.pop() + stack.pop();
            }
           
        }
        return result;
    }
```