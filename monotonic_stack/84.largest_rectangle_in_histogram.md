84. largest rectangle in histogram


![alt text](https://github.com/corykingsf/hack-interview-handboook-pixel/blob/main/imgSnipaste_2021-06-21_20-46-20.png)

```java
class Solution {
    private class Rect {
        private int height;
        private int width;
        Rect(int height, int width) {
            this.height = height;
            this.width = width;
        }
    }
    public int largestRectangleArea(int[] heights) {
        if (heights == null ||heights.length == 0) return 0;
        int n = heights.length;
        int[] heightsWithZero = Arrays.copyOf(heights, n +1); //拷贝原数组
        heightsWithZero[n] = 0; //，末尾补上一个0，帮助我们最后把栈清空
        Deque<Rect> s = new ArrayDeque<>();
        
        int ans = 0;
        // 每个柱子入栈、出栈各一次，2n=O(n)        
        // 第一步：for 每个元素
        for (int h : heightsWithZero) {
            int accumulatedWidth = 0;
            // 第二步：while (栈顶不满足高度单调性) 累加宽度，出栈
            while (!s.isEmpty() && s.peekFirst().height >= h) {
                accumulatedWidth += s.peekFirst().width;
                ans = Math.max(ans, accumulatedWidth * s.peekFirst().height);//弹出之前更新答案
                s.pollFirst();  //弹出
            }
            // 第三步：新元素入栈
            Rect rect = new Rect(h, accumulatedWidth + 1);
            s.offerFirst(rect);
        }
        return ans;
    }
}

```